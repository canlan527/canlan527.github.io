---
layout: archive
title:  小程序云开发 
date:   2019-10-15 23:15:37 +0800
tags: 微信小程序与云开发
---
# 小程序云开发

## 一、云开发与Serverless

### 1.什么是小程序云开发

#### 传统开发的现状

对比小程序传统模式，小程序端是展示数据给用户看的，展示的数据并不是在前端界面写死的，都需要一个后端，当小程序向后端发送请求的时候，后端把数据返回给前端，给客户展示 。前端人员和后端沟通浪费效率，甚至比开发的时间还要多。

![1568078469877](C:\Users\Shaw\AppData\Roaming\Typora\typora-user-images\1568078469877.png)

并不是把页面写死就能完全绕开后端，比如：

1. 数据的读取，小程序中存在大量数据，数据与数据之间存在大量关联关系查询，需要借助数据库来实现业务的需求
2. 很多项目，需要对文件进行管理，对图片、文档、视频等资源进行上传或下载，也需要借助后端
3. 很多时候会涉及到比较敏感的逻辑操作，比如用户的权限管理，不同用户有不同的权限，都需要后端来实现，传统开发中，小程序端都必须**发送请求到后端进行鉴权处理**，同时得到相应数据。
4. 开发完项目，还需要运维操作，比如说负载均衡，当我们的项目访问量达到一定级别的时候需要处理的问题
5. DB的运维，随着用户量不断增多，数据量不断增大的时候，数据库可能需要进行扩容
6. 网络防护，当前部署的服务器是否安全，能经受的起网络的攻击
7. 异地容灾，当我们当前的服务器出现问题的时候，如何让用户无感知的切换我们的服务器
8. 当我们把后端部署在服务器上的时候，需要买域名买服务器，还需要备案，周期太长

![1568085412450](C:\Users\Shaw\AppData\Roaming\Typora\typora-user-images\1568085412450.png)

#### 云开发模式

同样的，小程序端会承载数据、图片给用户看，在云开发模式中，小程序直接调用自己原生的接口，去操作云数据库、云函数、云存储。	前端人员这时候，不需要考虑运维问题，直接将关注放在业务上就可以。

除了小程序原生接口，也可以直接通过云函数调用云数据库和云存储。

不管是小程序端还是云函数，都可以通过统一的接口，去处理云开发提供的这些能力。

另外，云函数还提供了云调用能力，我们可以通过云函数直接使用小程序一些开放接口的能力，除此之外，还有HTTP API，让开发者在已经有服务器的情况下，去访问我们的云资源，实现与云开发的互通。

通过云开发的模式，可以释放我们开发者的手脚，赋予我们开发者一些**更安全、更稳定的去读取数据、上传文件以及控制权限等能力**，运维问题也会帮我们处理好。我们开发新的小程序的架构变得非常简单，**云函数就相当于后端，用nodeJS写我们的后台逻辑**；在云开发的云函数中，我们可以很轻易的获取用户的appid，openID等重要的鉴权信息，大大简化了小程序后台的开发量。如果我们已经具有了一个现成的小程序，我们部分需求需要与后端进行交互，我们可以通过云调用和HTTP API方式，将云函数作为路由，这样就可以通过现有的后端与云开发进行交互。

![1568087311984](C:\Users\Shaw\AppData\Roaming\Typora\typora-user-images\1568092996177.png)

### 2.什么是Serverless?

#### 物理隔离与Serverless

随着前端的边界在不断的扩大，在这个发展中一直有一个很深的隔离，——**物理隔离**。前端和后端存在着物理隔离，手机端和服务器也存在物理隔离，Serverless就是打破这个隔离的。对于前端来说，后端的服务就是一个函数，函数呢，就是前端代码的一部分，前端和后端完全融合到一个代码体当中，当Serverless完全打破这种隔离以后，才能真正的帮助后端，实现全栈的概念。

![1568101992858](C:\Users\Shaw\AppData\Roaming\Typora\typora-user-images\1568101992858.png)



前端、后端、服务器都存在物理隔离。首先是**后端**的物理隔离，每个服务器都存在物理隔离，我们通过云端化，把代码上传到云端的平台，这时候云端平台就是屏蔽我们机器之间的物理隔离，开发者可能感觉不到，所以有了云端化以后我们后端的物理隔离就会被消除；在**前端**和服务器之间，前端从服务器去数据的时候，一般都发送http请求到后端，后端去请求数据返回前端。使用serverless可以打破这种隔离，serverless并不是说没有服务器的，而是服务器部署在云上面，前端用函数就能实现读取数据，不需要关心函数来自前端后端还是服务器，也加快了项目上线的时间，降低后期维护和扩展的复杂性。 

![1568102660673](C:\Users\Shaw\AppData\Roaming\Typora\typora-user-images\1568102660673.png)

## 二、云开发优势与基础能力

为什么说云开发正在改变小程序的开发模式？

——在云开发当中，整个小程序的前后端逻辑，我们是在一个开发过程中完成的，不需要关心哪部分是前端，哪部分是后端，我们只需要像前端调用函数一样就可以，现在云函数也支持本地调试，调试云端代码的时候和调试前端代码是一样的，真正做到了前端全栈开发技术这样的开发模式，所以说这是一个很大的更新。

### 云开发优势

- 快速上线
- 专注核心业务
- 独立开发一个完整的微信小程序
- 不需要学习新语言，只要JS
- 无需运维，节约成本
- 弹性伸缩
- 数据安全

### 云开发提供了哪些能力？

#### 云开发基础能力

- 云函数：在云端运行的代码，微信私有协议天然鉴权
- 云数据库：一个既可以在小程序端操作又可以在云函数中操作的JSON数据库
- 云存储：在云端存储文件，可以在云端控制台可视化管理
- 云调用：基于云函数免鉴权使用小程序开放接口的能力
- HTTP API：使用HTTP API开发者可以在已有服务器上访问云资源，实现与云开发的互通

